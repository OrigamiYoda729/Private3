function getSearchResults(n){var i=new Json.Request(n._serviceUrl,n._service),t;i.onSuccess=function(t){var r,u,f,i,e;if(!n.verifySearchParameters()){r={};n.getSearchParameters();n._Params&&(r=n._Params);typeof r.isInternetViewerRequest=="undefined"&&(r.isInternetViewerRequest=n._isInternetViewerRequest);u=new Json.Request(n._serviceUrl,n._service);u.onSuccess=arguments.callee;u.invoke(r);return}for(f=[],i=0;i<t.length;i++)f[i]={searchResult:t[i],text:t[i][n._valueKey]};n._searchResult.render(f);e=n._searchResult.getElement();n.onShowResults(e.childNodes[0]);jQuery("#uxSearchResult").removeClass("loading");n._isProcessing=!1};t=function(){var t,r;if(!n._isProcessing){if(t={},n.getSearchParameters(),n._Params&&(t=n._Params),typeof t.isInternetViewerRequest=="undefined"&&(t.isInternetViewerRequest=n._isInternetViewerRequest),t.firstName==""&&t.lastName==""){r=n._anchorElement.parentNode.getElementsByTagName("UL");r.length>0&&Element.remove(r[0]);Element.show($("uxInstruction"));return}n._isProcessing=!0;n._hasSelection=!1;jQuery("#uxSearchResult").addClass("loading");i.invoke(t)}};n._Timer||(n._Timer=new Timer,n._Timer.lastRequestTime=new Date);(new Date).getTime()-n._Timer.lastRequestTime.getTime()<500&&(n._Timer.lastRequestTime=new Date,n._Timer.clear(),n._Timer.setTimeout(t,500));n._Timer.setTimeout(t,500)}AdvancedSearch=function(n,t,i,r,u,f,e){this._serviceUrl=n;this._service=t;this._valueKey=r;this._idKey=i;this._isInternetViewerRequest=e;this._Params={};this._anchorElement=f;this._inputControls=u;this.addEvents();this._searchResult=new SearchResults(this._anchorElement,!0);this._searchResult.onSelected=this.onClickItem.getCallback(this);this._searchResult.onClosing=this.onCloseList.getCallback(this)};AdvancedSearch.prototype.addEvents=function(){for(var n=0;n<2;n++)Event.addListener(this._inputControls[n],"keyup",this._onKeyUp,this),Event.addListener(this._inputControls[n],"keydown",this._onKeyDown,this);Event.addListener(this._inputControls[2],"change",this._onChange,this)};AdvancedSearch.prototype.removeEvents=function(){for(var n=0;n<2;n++)Event.removeListener(this._inputControls[n],"keyup",this._onKeyUp,this),Event.removeListener(this._inputControls[n],"keydown",this._onKeyDown,this);Event.removeListener(this._inputControls[2],"change",this._onChange,this)};AdvancedSearch.prototype.isModifierKeyPressed=function(n){var t=n.altKey,i=n.ctrlKey;return t||i};AdvancedSearch.prototype._isValidKey=function(n){switch(n){case 9:case 13:case 16:case 17:case 20:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return!1;default:return!0}};AdvancedSearch.prototype.getSearchParameters=Function.empty;AdvancedSearch.prototype.verifySearchParameters=Function.empty;AdvancedSearch.prototype._onChange=function(){getSearchResults(this)};AdvancedSearch.prototype._onKeyUp=function(n){(Event.normalize(n),n.keyCode==40&&this._searchResult.selectFirst(this._anchorElement.parentNode),this._isValidKey(n.keyCode)&&!this.isModifierKeyPressed(n))&&getSearchResults(this)};AdvancedSearch.prototype._onKeyDown=function(n){n.keyCode==13&&n.preventDefault()};AdvancedSearch.prototype.onItemSelected=Function.Empty;AdvancedSearch.prototype.onClickItem=function(n,t){this._itemSelected=t[this._idKey];this._item=t;this._hasSelection=!0;this.onItemSelected(t[this._idKey],t)};AdvancedSearch.prototype.onCloseList=function(){this.removeEvents()};