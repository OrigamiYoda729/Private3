function Color(n){(p=Color._rgb.exec(n))?(this.r=parseInt(p[1],10),this.g=parseInt(p[2],10),this.b=parseInt(p[3],10)):(p=Color._hex6.exec(n))?(this.r=parseInt(p[1],16),this.g=parseInt(p[2],16),this.b=parseInt(p[3],16)):(p=Color._hex3.exec(n))&&(this.r=parseInt(p[1]+p[1],16),this.g=parseInt(p[2]+p[2],16),this.b=parseInt(p[3]+p[3],16))}Color._rgb=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/;Color._hex6=/^#(\w{2})(\w{2})(\w{2})$/;Color._hex3=/^#(\w{1})(\w{1})(\w{1})$/;Color.prototype.toRgb=function(){return"rgb("+this.r+","+this.g+","+this.b+")"};Color.prototype.toHex=function(){return"#"+this.r.toHex(2)+this.g.toHex(2)+this.b.toHex(2)};Effect={};Effect.fadeIn=function(n,t,i){function r(){var e=f.elapsed();e<t?(Element.setOpacity(n,u*e),window.setTimeout(r,10)):(Element.setOpacity(n,1),i&&i(n))}var u=1/t,f=new Date;window.setTimeout(r,10)};Effect.fadeOut=function(n,t,i){function r(){var e=f.elapsed();e<t?(Element.setOpacity(n,1-u*e),window.setTimeout(r,10)):(Element.setOpacity(n,0),i&&i(n))}var u=1/t,f=new Date;window.setTimeout(r,10)};Effect.slide=function(n,t,i,r,u){function o(){var l=c.elapsed();l<r?(Element.moveTo(n,f+s*l,e+h*l),window.setTimeout(o,10)):(Element.moveTo(n,f+t,e+i),u&&u(n))}t-=n.offsetLeft;i-=n.offsetTop;var s=t/r,h=i/r,f=n.offsetLeft,e=n.offsetTop,c=new Date;window.setTimeout(o,10)};Effect.getColor=function(n){while(n){var t=Element.getStyle(n,"backgroundColor");if(t&&t!=="transparent"&&t!=="rgba(0, 0, 0, 0)")return new Color(t);n=n.parentNode}return new Color("#FFF")};Effect.yellowFade=function(n,t){function f(){var t=h.elapsed();t<r?(n.style.backgroundColor="rgb("+Math.round(i.r+e*t)+","+Math.round(i.g+o*t)+","+Math.round(i.b+s*t)+")",window.setTimeout(f,10)):n.style.backgroundColor=""}if(t){n.style.backgroundColor="#FF0";return}var r=1e3,i=new Color("#FF0"),u=Effect.getColor(n),e=(u.r-i.r)/r,o=(u.g-i.g)/r,s=(u.b-i.b)/r,h=new Date;window.setTimeout(f,10)};Effect.shadeDown=function(n,t,i){var f=1e3/80,e=t*.06,r=0,u;Element.setHeight(n,r);u=function(){r<=t?(Element.setHeight(n,r),r+=e,window.setTimeout(u,f)):i&&i()};u()};